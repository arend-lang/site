<html><head><title>Root</title><link rel="stylesheet" href="RootHTML/Arend.css"></head><body><pre class="Arend"><a id="124012" class="BLOCK_COMMENT">{- TODO&#10;\import Algebra.Meta&#10;\import Algebra.Monoid&#10;\import Algebra.Ordered&#10;\import Algebra.Ring&#10;\import Arith.Rat&#10;\import Arith.Real&#10;\import Arith.Real.Field&#10;\import Data.Or&#10;\import Function.Meta&#10;\import Logic&#10;\import Logic.Meta&#10;\import Meta&#10;\import Order.Lattice&#10;\import Order.LinearOrder&#10;\import Order.PartialOrder&#10;\import Order.StrictOrder&#10;\import Paths&#10;\import Paths.Meta&#10;\open Monoid(pow)&#10;\open LinearlyOrderedSemiring&#10;\open LinearOrder \hiding (&lt;=, Dec)&#10;&#10;\func rootR (n : Nat) (x : Real) (x&gt;=0 : 0 &lt;= x) : Real \cowith&#10;  | L a =&gt; (a &lt; 0) || x.L (pow a n)&#10;  | L-inh =&gt; inP (-1, byLeft idp)&#10;  | L-closed {q} {q'} e q'&lt;q =&gt; \case dec&lt;_&lt;= q' 0, \elim e \with {&#10;    | inl q'&lt;0, _ =&gt; byLeft q'&lt;0&#10;    | inr q'&gt;=0, byLeft q&lt;0 =&gt; absurd linarith&#10;    | inr q'&gt;=0, byRight q^n&lt;x =&gt; byRight $ x.L_&lt;= q^n&lt;x $ pow_&lt;=-monotone q'&gt;=0 $ &lt;_&lt;= q'&lt;q&#10;  }&#10;  | L-rounded {q} =&gt; \case dec&lt;_&lt;= q 0, \elim __ \with {&#10;    | inl q&lt;0, _ =&gt; inP (RatField.mid q 0, byLeft $ RatField.mid&lt;right q&lt;0, RatField.mid&gt;left q&lt;0)&#10;    | inr q&gt;=0, byLeft q&lt;0 =&gt; absurd (q&gt;=0 q&lt;0)&#10;    | inr q&gt;=0, byRight q^n&lt;x =&gt; \case L-rounded q^n&lt;x \with {&#10;      | inP (b,b&lt;x,q^n&lt;b) =&gt; \case pow-L-rounded q&gt;=0 q^n&lt;b \with {&#10;        | inP (r,q&lt;r,r^n&lt;b) =&gt; inP (r, byRight $ L-closed b&lt;x r^n&lt;b, q&lt;r)&#10;      }&#10;    }&#10;  }&#10;  | U b =&gt; x.U (pow b n)&#10;  | U-inh =&gt; {?}&#10;  | U-closed =&gt; {?}&#10;  | U-rounded =&gt; {?}&#10;  | LU-disjoint =&gt; {?}&#10;  | LU-located =&gt; {?}&#10;  | LU-focus =&gt; {?}&#10;  \where {&#10;    \sfunc pow&gt;0-rounded {b : Rat} {n : Nat} (n/=0 : n /= 0) (b&gt;0 : 0 &lt; b) : \Sigma (a : Rat) (0 &lt; a) (pow a n &lt; b)&#10;      =&gt; ((b ∧ 1) * ratio 1 2, RatField.&lt;_*_positive_positive (&lt;_meet-univ b&gt;0 idp) idp, transport2 (&lt;) (inv CMonoid.pow_*-comm) ide-right $&#10;            &lt;_*_positive-right {_} {pow (b ∧ 1) n} {pow (ratio 1 2) n} {1} (RatField.pow&gt;0 $ &lt;_meet-univ b&gt;0 idp) (pow&lt;=id (&lt;_&lt;= $ later idp) (&lt;_&lt;= $ later idp) n/=0 &lt;∘r idp) &lt;∘l {_} {_} {_} {b * 1}&#10;            transport2 (&lt;=) (inv ide-right) (inv ide-right) (pow&lt;=id (meet-univ (&lt;_&lt;= b&gt;0) $ &lt;_&lt;= zro&lt;ide) meet-right n/=0 &lt;=∘ meet-left))&#10;&#10;    \lemma pow-L-rounded {a b : Rat} (a&gt;=0 : 0 &lt;= a) {n : Nat} (a^n&lt;b : pow a n &lt; b) : ∃ (a' : Rat) (a &lt; a') (pow a' n &lt; b) \elim n&#10;      | 0 =&gt; inP (a + 1, linarith, a^n&lt;b)&#10;      | suc n =&gt; \case dec&lt;_&lt;= 0 a \with {&#10;        | inl a&gt;0 =&gt; \case (RealField.*_positive-U (RatField.pow&gt;0 a&gt;0) a&gt;0).1 $ rewrite RealField.*-rat a^n&lt;b \with {&#10;          | inP (b',a',a^n&lt;b',a&lt;a',b'a'&lt;b) =&gt; \case pow-L-rounded a&gt;=0 a^n&lt;b' \with {&#10;            | inP (a'',a&lt;a'',a''^n&lt;b') =&gt;&#10;              \have a'a''&gt;0 : 0 &lt; a' ∧ a'' =&gt; &lt;_meet-univ (a&gt;=0 &lt;∘r a&lt;a') (a&gt;=0 &lt;∘r a&lt;a'')&#10;              \in inP (a' ∧ a'', &lt;_meet-univ a&lt;a' a&lt;a'', &lt;=_*_positive-right (&lt;_&lt;= $ RatField.pow&gt;0 $ a'a''&gt;0) meet-left &lt;∘r&#10;                  &lt;=_*_positive-left (pow_&lt;=-monotone (&lt;_&lt;= a'a''&gt;0) meet-right &lt;=∘ &lt;_&lt;= a''^n&lt;b') (&lt;_&lt;= $ a&gt;=0 &lt;∘r a&lt;a') &lt;∘r b'a'&lt;b)&#10;          }&#10;        }&#10;        | inr a&lt;=0 =&gt;&#10;          \have | a=0 : a = 0 =&gt; &lt;=-antisymmetric a&lt;=0 a&gt;=0&#10;                | r =&gt; pow&gt;0-rounded {b} {suc n} (\case __) $ rewrite (a=0,Algebra.Ring.Ring.zro_*-right) in a^n&lt;b&#10;          \in inP (r.1, rewrite a=0 r.2, r.3)&#10;      }&#10;  }&#10;-}</a><script src="RootHTML/highlight-hover.js"></script></pre></body></html>